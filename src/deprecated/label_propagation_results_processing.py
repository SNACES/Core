from new_algo_clustering_mongo_dao import *
from new_algo_clustering import *
from clustering import *

cluster_dict = {0: ['david_madras', 'vanillatary'], 1: ['david_madras', 'abbagoldbot'], 2: ['david_madras', 'Limericking'], 3: ['david_madras', 'ProbCausation'], 4: ['david_madras', 'fermatslibrary'], 5: ['david_madras', 'A_single_bear'], 6: ['david_madras', 'TedOnPrivacy'], 7: ['david_madras', 'JesseBrown', 'CANADALAND'], 8: ['david_madras', 'NBA_Math', 'ZachLowe_NBA', 'bencfalk', 'TorontoStar', 'ekoreen', 'dmorey', 'bruce_arthur', 'AndrewDBailey', 'OldHossRadbourn'], 9: ['david_madras', 'MicroSFF'], 10: ['david_madras', 'GeoffRockwell'], 11: ['david_madras', 'dril'], 12: ['david_madras', 'chancetherapper', 'pitchfork', 'vincestaples'], 13: ['david_madras', 'HMSHCP'], 14: ['david_madras', 'ProBirdRights'], 15: ['david_madras', 'randal_olson', 'rctatman', 'MarzyehGhassemi', 'mattschleg', 'aerinykim', 'hannawallach', 'HelloHops', 'CausalKathy', 'Aaroth', 'sarahcolq', 'MrDanielMax', 'rajiinio', 'SingularMattrix', 'SussilloDavid', 'KLdivergence', 'tdietterich', 'langston_poems', 'hardmaru', 'ddebow', 'risk4bisc', 'RandomlyWalking', 'korymath', 'packer_ben', 'A_Aspuru_Guzik', 'ceh0', 'coolboi95', 'nickfrosst', 'annakoop', 'jasserole', 'mmitchell_ai', 'RonSoupprune', 'thesasho', 'Mo_Fad3l', 'databoydg', 'jh_jacobsen', 'orionbuske', 'chloepouprom', 'suchisaria', 'berty38', 'beenwrekt', 'payaicha15', 'NicolasPapernot', 'iamstripedhorse', 'melosare', 'zacharylipton', 'octonion', 'liannapisani', 'TaiUdovicic', 'mariadearteaga', 'yoavgo', 'leeclemnet', 'aivillage_dc', 'carrasqu', 'david_sontag', 'james_r_lucas', 'nicohowe', 'roydanroy', '_asubbaswamy', 'dramemariama20', '1vnzh', 'math_rachel', 'j_asminewang', 'dirk_hovy', 'notsapphoe', 'tw_killian', 'sina_lana', 'ShalitUri', 'haldaume3', 'mchlglry', 'angelamczhou', 'leilanigilpin', 'patrickcorneil', 'megberetta', 'jackclarkSF', 'jennwvaughan', 'ermgrant', 'julius_adebayo', '_galyo', 'raebett', 'kswersk', 'panfordkobby', 'goodfellow_ian', 'EthanFetaya', 'ltondji', 'mtesfald', 'johnmyleswhite', 'alexdamour', 'tyrell_turing', '__sarah_anne__', 'AkiyoshiKitaoka', 'blancamiller_', 'realnamepolicy', 'SoloGen', 'JaggamanJames', 'jamiemorgenste1', 'Smerity', 'james_c_atwood', 'ZOMGZinc', '_HeatherE', 'judyhshen', 'geomblog', 'mark_riedl', 'AmirRosenfeld', 'marthadarby', 'fhuszar', 'MattBobkin', 'slydesilva', 'mikekimbackward', 'jessebett', 'SirrahChan', 'mrtz', 'AidanNGomez', 'kongaloosh', 'random_walker', 'VectorInst', 'alex_y_gao', 'Lv100Swagneton', 'maria__cuellar', 'wgrathwohl', 'edwardhkennedy', 'adversariel', 'Miles_Brundage',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  'cobyviner', 'umangsbhatt', 'RogerGrosse', 'PariAIML', 'moyix', 'catherineols', 'osageev', 'jefrankle', 'variationalBAE'], 16: ['david_madras', 'rxgau'], 17: ['david_madras', 'CBCNews', 'dsouzamichaelc'], 18: ['david_madras', 'aliceysu'], 19: ['david_madras', 'jen_keesmaat', 'GraphicMatt', 'm_layton'], 20: ['david_madras', 'DoctorVive', 'GeoffreySupran'], 21: ['david_madras', 'forexposure_txt'], 22: ['david_madras', 'tabletmag', 'rabbijilljacobs', 'jstreetdotorg', 'haaretzcom', 'EgSophie'], 23: ['david_madras', 'ewarren'], 24: ['david_madras', 'dhackett1565', 'wtevs', 'joey_doubleyou', 'william_lou', 'BlakeMurphyODC', 'AnnaJaneSmith4'], 25: ['david_madras', 'whatwouldDOOdo', 'ithrow88'], 26: ['david_madras', 'carolinespence_', 'JasonIsbell'], 27: ['david_madras', 'theneedledrop', 'LStanley24', 'exclaimdotca', 'IanGormely'], 28: ['david_madras', 'Kurt_Vonnegut'], 29: ['david_madras', 'alexstamos', 'elyratner', 'TimHarford', 'causalinf', 'grimmelm', 'Noahpinion', 'ModeledBehavior', 'ashleyfeinberg', 'mkoplow', 'mikarv', 'AINowInstitute', 'ErikLoomis', 'mbogen', 'j2bryson', 'matthewstoller', 'BrendanNyhan', 'DaraKaye', 'natematias', 'ollie', 'SolomonMg', 'mattyglesias', 'NateSilver538', 'peltzmadeline', 'benzevgreen', 'LisPower1', 'timoreilly', 'team_markup', 'GretchenAMcC', 'bencasselman', 'SeanTrende', 'juliagalef', 'gelliottmorris', 'LorenRaeDeJ', 'JohnHolbein1', 'EvanSelinger', 'jasonmillar', '3r1nG', 'willsommer', 'Nate_Cohn', 'curaffairs', 'BrendaKLeong', 'OsitaNwanevu', 'jessesingal', 'RespectableLaw', 'julia_azari', 'skepticalsports', 'SethAMandel', 'Undercoverhist', 'ContraPoints', 'AlecMacGillis', 'TerribleMaps', 'BKCHarvard', 'leah_boustan', 'ggreenwald', 'byrdinator', 'ShannonVallor', 'qjurecic', 'ndiakopoulos', 'MattGertz', 'ghadfield', 'SeanMcElwee', 'TrooperSanders', 'MichaelSLinden', 'maya_sen', 'nathanjurgenson', 'JuliaAngwin', 'zittrain', 'ddale8', 'madbev14', 'ne0liberal', 'egavactip', 'HeerJeet', 'timhwang', 'lawfareblog', 'theintercept', 'Yair_Rosenberg', 'SarahJamieLewis', 'ForecasterEnten', 'elanazeide', 'alexhanna', 'linamkhan', 'ncasenmare', 'harvard_data', 'propublica', 'SatterthwaiteML', 'aprilaser', 'wsisaac', 'briebriejoy', 'elizabeth_joh', 'supergovernance', 'dick_nixon', 'superwuster', 'WillOremus', 'FrankPasquale', 'lawlkat', 'Richard_Florida', 'zeynep', 'Susan_Athey', 'KT_So_It_Goes', 'MarkupReal', 'katecrawford', 'ClareMalone', 'SarahTaber_bww', 'poverty_action', 'mathbabedotorg'], 30: ['david_madras', 'computerfact']}

# sort cluster_dict by len of cluster
cluster_id_for_sorted = sorted(cluster_dict, key=lambda k: len(cluster_dict[k]), reverse=True)

file_name = "label_propagation_results"
file_object = open(file_name, 'w')
for cluster_id in cluster_id_for_sorted:
    users = cluster_dict[cluster_id]
    users.sort()
    
    dao = NewAlgoClusteringMongoDAO()
    rwf = dao.get_rwf()

    cluster_rwf = cluster_relative_frequency(rwf, users)
    most_typical_words = []
    for item in cluster_rwf.most_common(10):
        most_typical_words.append(item[0])
    most_typical_words.sort()
    
    cluster_info = "Users: {}\nMost Typical Words: {}\n\n".format(users, most_typical_words)
    file_object.write(cluster_info)